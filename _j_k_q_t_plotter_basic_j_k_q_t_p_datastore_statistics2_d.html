<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JKQTPlotter: Tutorial (JKQTPDatastore): Advanced 2-Dimensional Statistics with JKQTPDatastore</title>
<meta name="description" content="an extensive Qt5+Qt6 Plotter framework (including a feature-richt plotter widget, a speed-optimized, but limited variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies">
<meta name="keywords" lang="en-us" content="C++, C++11, Qt, Qt5, Qt6, Plotting, Plot, Chart, Graph, Qt, Widget, C++, Library, Visualization, charting library, plotting library, scientific visualization, data visualization, statistics, statistical methods, statistics library, LaTeX parser, LaTeX renderer, Qt widget, Qt5 widget, Qt6 widget, Qt charts, Qt plots, barchart, violinplot, boxplot, JKQtPlotter, JKQTMathText, JKQTFastPlotter">
<meta name="author" content="$author">
<meta name="copyright" content="(c) 2008-2022 by $author">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="jkqtplotter_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo_doxygen.png"/></td>
  <td id="projectalign">
   <div id="projectname">JKQTPlotter<span id="projectnumber">&#160;trunk/v5.0.0</span>
   </div>
   <div id="projectbrief">an extensive Qt5+Qt6 Plotter framework (including a feature-richt plotter widget, a speed-optimized, but limited variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="topics.html"><span>Topics</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics2_d.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Tutorial (JKQTPDatastore): Advanced 2-Dimensional Statistics with JKQTPDatastore</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md59">Generating different sets of random numbers</a></li>
<li class="level1"><a href="#autotoc_md60">Marginal Statistics</a></li>
<li class="level1"><a href="#autotoc_md61">2D Histogram</a></li>
<li class="level1"><a href="#autotoc_md62">Kernel Density Estimates (KDE)</a></li>
<li class="level1"><a href="#autotoc_md63">Screenshot of the full Program</a></li>
</ul>
</div>
<div class="textblock"><p>This tutorial project (see <code>./examples/datastore_statistics_2d/</code>) explains several advanced functions of <a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a> in combination with the [<a class="el" href="group__jkqtptools__math__statistics.html">JKQTPlotter Statistics Library</a>] conatined in <a class="el" href="class_j_k_q_t_plotter.html" title="plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)">JKQTPlotter</a>.</p>
<p><em><b>Note</b></em> that there are additional tutorial explaining other aspects of data mangement in <a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a>:</p><ul>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore.html">Basic Usage of JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_iterators.html">Iterator-Based usage of JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics.html">Advanced 1-Dimensional Statistics with JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_regression.html">Regression Analysis (with the Statistics Library)</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics_grouped_stat.html">1-Dimensional Group Statistics with JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics2_d.html">Advanced 2-Dimensional Statistics with JKQTPDatastore</a></li>
</ul>
<p>The source code of the main application can be found in <a href="https://github.com/jkriege2/JKQtPlotter/tree/master/examples/datastore_statistics_2d/datastore_statistics_2d.cpp"><code>datastore_statistics_2d.cpp</code></a>. This tutorial cites only parts of this code to demonstrate different ways of working with data for the graphs.</p>
<h1><a class="anchor" id="autotoc_md59"></a>
Generating different sets of random numbers</h1>
<p>The code segments below will fill different instances of <a class="el" href="class_j_k_q_t_plotter.html" title="plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)">JKQTPlotter</a> with different statistical plots. All these plots are based on either of two sets of random number pairs (<a class="el" href="class_j_k_q_t_p_final_act.html#af964d2f5e77728dfe65e13964ea9b02a">i.e</a>. x/y-locations) generated as shown here: </p><div class="fragment"><div class="line"><span class="keywordtype">size_t</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;addColumn(<span class="stringliteral">&quot;random data, x&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;addColumn(<span class="stringliteral">&quot;random data, y&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoldist_small</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;addColumn(<span class="stringliteral">&quot;random data, distribution/class&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;addColumn(<span class="stringliteral">&quot;random data, x&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;addColumn(<span class="stringliteral">&quot;random data, y&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoldist</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;addColumn(<span class="stringliteral">&quot;random data, distribution/class&quot;</span>);</div>
<div class="line"><span class="comment">// random number generators:</span></div>
<div class="line">std::random_device rd;</div>
<div class="line">std::mt19937 gen{rd()};</div>
<div class="line">std::uniform_int_distribution&lt;&gt; <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">ddecide</a>(0,2);</div>
<div class="line">std::normal_distribution&lt;&gt; <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d1x</a>{5,3};</div>
<div class="line">std::normal_distribution&lt;&gt; <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d1y</a>{5,1};</div>
<div class="line">std::normal_distribution&lt;&gt; <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d2x</a>{10,2};</div>
<div class="line">std::normal_distribution&lt;&gt; <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d2y</a>{10,5};</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">i</a>=0; <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">i</a>&lt;500; <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">i</a>++) {</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">rx</a>=0,<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">ry</a>=0;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">decide</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">ddecide</a>(gen);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">decide</a>==0) {</div>
<div class="line">        <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">rx</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d1x</a>(gen);</div>
<div class="line">        <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">ry</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d1y</a>(gen);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">rx</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d2x</a>(gen);</div>
<div class="line">        <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">ry</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d2y</a>(gen);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">i</a>&lt;150) {</div>
<div class="line">        <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;appendToColumn(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">rx</a>);</div>
<div class="line">        <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;appendToColumn(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">ry</a>);</div>
<div class="line">        <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;appendToColumn(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoldist_small</a>, std::min(1,<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">decide</a>));</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;appendToColumn(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">rx</a>);</div>
<div class="line">    <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;appendToColumn(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">ry</a>);</div>
<div class="line">    <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;appendToColumn(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoldist</a>, std::min(1,<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">decide</a>));</div>
<div class="line">}</div>
<div class="ttc" id="aclass_j_k_q_t_p_final_act_html"><div class="ttname"><a href="class_j_k_q_t_p_final_act.html">JKQTPFinalAct</a></div><div class="ttdoc">C++11 finally construct (executes a callable-object when the edestructor is executed)</div><div class="ttdef"><b>Definition</b> jkqtpcodestructuring.h:48</div></div>
</div><!-- fragment --><p>The columns <code>randomdatacolx</code> and <code>randomdatacoly</code> will contain 500 random numbers. Each one is drawn either from the normal distributions <code>d1x</code>/<code>d1y</code>, or <code>d2x</code>/<code>d2y</code>. The decision, which of the two to use is based on the result of a third random distribution <code>ddecide</code>, which only returns 0, 1 or 2 (<code>d1x</code>/<code>d1y</code> is chosen for <code>ddecide==0</code>). The column <code>randomdatacoldist</code> finally encodes which pair of distributions was chosen. The three columns <code>randomdatacolx_small</code>, <code>randomdatacoly_small</code> and <code>randomdatacoldist_small</code> represent a subset of the first 150 numbers from the full dataset. The columns are generated empty by calling <code><a class="el" href="class_j_k_q_t_p_datastore.html#ae057eda96c7b754cd42f4380b429a589" title="add a new column to the datastore and return its ID">JKQTPDatastore::addColumn()</a></code> with only a name. Then the actual values are added by calling <code><a class="el" href="class_j_k_q_t_p_datastore.html#a3a992ac63957ce0c521e48944f704d91" title="adds a value value to the column column. This changes the column length (number of rows).">JKQTPDatastore::appendToColumn()</a></code>.</p>
<p>The datasets generated above can be plotted using a simple scatterplot (here shown for the full dataset only): </p><div class="fragment"><div class="line"><a class="code hl_class" href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html">JKQTPXYParametrizedScatterGraph</a>* <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gDataHist</a>;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>-&gt;addGraph(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gDataHist</a>=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html">JKQTPXYParametrizedScatterGraph</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>));</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gDataHist</a>-&gt;setXYColumns(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>,<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gDataHist</a>-&gt;setSymbolColumn(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoldist</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">QMap&lt;double, JKQTPGraphSymbols&gt;</a> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">mapped</a>;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">mapped</a>[0]=<a class="code hl_enumvalue" href="group__jkqtptools__drawing.html#ggacdaaac6baeadbfd3677d4d53ea594b5ba7d1d103c92b5fb6152ddf135315f3449">JKQTPGraphSymbols::JKQTPCross</a>;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">mapped</a>[1]=<a class="code hl_enumvalue" href="group__jkqtptools__drawing.html#ggacdaaac6baeadbfd3677d4d53ea594b5badd74965fc1b02e29ba1d9b34a99ffc9b">JKQTPGraphSymbols::JKQTPPlus</a>;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gDataHist</a>-&gt;setMappedSymbolColumnFunctor(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">mapped</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gDataHist</a>-&gt;setSymbolSize(5);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gDataHist</a>-&gt;setSymbolColor(<a class="code hl_function" href="group__jkqtpplotter__styling__classes.html#ga4840ec94f56ddc9df4bf5d2c3d0c15ae">QColorWithAlphaF</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">QColor</a>(<span class="stringliteral">&quot;red&quot;</span>), 0.7));</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gDataHist</a>-&gt;setDrawLine(<span class="keyword">false</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gDataHist</a>-&gt;setTitle(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">QString</a>(<span class="stringliteral">&quot;random data, $N=&quot;</span>+<a class="code hl_function" href="class_j_k_q_t_p_final_act.html#af964d2f5e77728dfe65e13964ea9b02a">QString::number</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;getRows(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoldist</a>))+<span class="stringliteral">&quot;$&quot;</span>));</div>
<div class="ttc" id="aclass_j_k_q_t_p_final_act_html_af964d2f5e77728dfe65e13964ea9b02a"><div class="ttname"><a href="class_j_k_q_t_p_final_act.html#af964d2f5e77728dfe65e13964ea9b02a">JKQTPFinalAct::JKQTPFinalAct</a></div><div class="ttdeci">JKQTPFinalAct(F f) noexcept</div><div class="ttdef"><b>Definition</b> jkqtpcodestructuring.h:50</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_y_parametrized_scatter_graph_html"><div class="ttname"><a href="class_j_k_q_t_p_x_y_parametrized_scatter_graph.html">JKQTPXYParametrizedScatterGraph</a></div><div class="ttdoc">This implements xy scatter plots (like JKQTPXYScatterGraph), but the color and size of the symbols ma...</div><div class="ttdef"><b>Definition</b> jkqtpscatter.h:153</div></div>
<div class="ttc" id="agroup__jkqtpplotter__styling__classes_html_ga4840ec94f56ddc9df4bf5d2c3d0c15ae"><div class="ttname"><a href="group__jkqtpplotter__styling__classes.html#ga4840ec94f56ddc9df4bf5d2c3d0c15ae">QColorWithAlphaF</a></div><div class="ttdeci">QColor QColorWithAlphaF(const QColor &amp;color, qreal alphaF)</div><div class="ttdoc">construct a QColor, based on the given color, but with alpha set to the specified value alphaF</div><div class="ttdef"><b>Definition</b> jkqtptools.h:362</div></div>
<div class="ttc" id="agroup__jkqtptools__drawing_html_ggacdaaac6baeadbfd3677d4d53ea594b5ba7d1d103c92b5fb6152ddf135315f3449"><div class="ttname"><a href="group__jkqtptools__drawing.html#ggacdaaac6baeadbfd3677d4d53ea594b5ba7d1d103c92b5fb6152ddf135315f3449">JKQTPCross</a></div><div class="ttdeci">@ JKQTPCross</div><div class="ttdoc">a X cross</div><div class="ttdef"><b>Definition</b> jkqtpdrawingtools.h:102</div></div>
<div class="ttc" id="agroup__jkqtptools__drawing_html_ggacdaaac6baeadbfd3677d4d53ea594b5badd74965fc1b02e29ba1d9b34a99ffc9b"><div class="ttname"><a href="group__jkqtptools__drawing.html#ggacdaaac6baeadbfd3677d4d53ea594b5badd74965fc1b02e29ba1d9b34a99ffc9b">JKQTPPlus</a></div><div class="ttdeci">@ JKQTPPlus</div><div class="ttdoc">a + cross</div><div class="ttdef"><b>Definition</b> jkqtpdrawingtools.h:103</div></div>
</div><!-- fragment --><p>In addition to get an idea of the used distributions, we can add two ellipses indicating the (doubled) standard deviations of the two distributions:</p>
<div class="fragment"><div class="line"><span class="comment">// 2.3. to visualize the initial distributions, we draw an ellipse indicating the</span></div>
<div class="line"><span class="comment">//      variance of the distributions</span></div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_geo_ellipse.html">JKQTPGeoEllipse</a>* <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gEll1Hist</a>;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_geo_ellipse.html">JKQTPGeoEllipse</a>* <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gEll2Hist</a>;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>-&gt;addGraph(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gEll1Hist</a>=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_p_geo_ellipse.html">JKQTPGeoEllipse</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d1x</a>.mean(), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d1y</a>.mean(),<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d1x</a>.stddev()*2.0,<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d1y</a>.stddev()*2.0));</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>-&gt;addGraph(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gEll2Hist</a>=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_p_geo_ellipse.html">JKQTPGeoEllipse</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d2x</a>.mean(), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d2y</a>.mean(),<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d2x</a>.stddev()*2.0,<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">d2y</a>.stddev()*2.0));</div>
<div class="ttc" id="aclass_j_k_q_t_p_geo_ellipse_html"><div class="ttname"><a href="class_j_k_q_t_p_geo_ellipse.html">JKQTPGeoEllipse</a></div><div class="ttdoc">This JKQTPGeometricPlotElement is used to draw an ellipse.</div><div class="ttdef"><b>Definition</b> jkqtpgeoshapes.h:300</div></div>
</div><!-- fragment --><p>The resulting plot looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_scatteronly.png" alt="datastore_statistics_2d_scatteronly" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md60"></a>
Marginal Statistics</h1>
<p>To explore the statistical properties of a 2D dataset, it is often useful to draw the marginal histograms, <a class="el" href="class_j_k_q_t_p_final_act.html#af964d2f5e77728dfe65e13964ea9b02a">i.e</a>. the histograms of one of the two variables. To do so, we use the function <code><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga8ff37e2bd7bd79311cca2c5cc3b65345" title="calculate an autoranged histogram and add a JKQTPBarVerticalGraph to the given plotter,...">jkqtpstatAddHHistogram1DAutoranged()</a></code> and <code><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga4797755e8ed88b52e524f38e49fd396e" title="calculate an autoranged histogram and add a JKQTPBarHorizontalGraph to the given plotter,...">jkqtpstatAddVHistogram1DAutoranged()</a></code> that were introduced in <a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics.html">Advanced 1-Dimensional Statistics with JKQTPDatastore</a> and are explained in detail there:</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga8ff37e2bd7bd79311cca2c5cc3b65345">jkqtpstatAddHHistogram1DAutoranged</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>-&gt;getPlotter(),  <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>), 1.0, <span class="keyword">true</span>);</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga4797755e8ed88b52e524f38e49fd396e">jkqtpstatAddVHistogram1DAutoranged</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>-&gt;getPlotter(),  <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>), 1.0, <span class="keyword">true</span>);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga4797755e8ed88b52e524f38e49fd396e"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga4797755e8ed88b52e524f38e49fd396e">jkqtpstatAddVHistogram1DAutoranged</a></div><div class="ttdeci">JKQTPBarHorizontalGraph * jkqtpstatAddVHistogram1DAutoranged(JKQTBasePlotter *plotter, InputIt first, InputIt last, int bins=11, bool normalized=true, bool cummulative=false, const QString &amp;histogramcolumnBaseName=QString(&quot;histogram&quot;))</div><div class="ttdoc">calculate an autoranged histogram and add a JKQTPBarHorizontalGraph to the given plotter,...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:941</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga8ff37e2bd7bd79311cca2c5cc3b65345"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga8ff37e2bd7bd79311cca2c5cc3b65345">jkqtpstatAddHHistogram1DAutoranged</a></div><div class="ttdeci">JKQTPBarVerticalGraph * jkqtpstatAddHHistogram1DAutoranged(JKQTBasePlotter *plotter, InputIt first, InputIt last, int bins=11, bool normalized=true, bool cummulative=false, const QString &amp;histogramcolumnBaseName=QString(&quot;histogram&quot;))</div><div class="ttdoc">calculate an autoranged histogram and add a JKQTPBarVerticalGraph to the given plotter,...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:828</div></div>
</div><!-- fragment --><p>Note that the plots are put into <code><a class="el" href="class_j_k_q_t_plotter.html" title="plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)">JKQTPlotter</a></code>-instances <code>plothistBottom</code> and <code>plothistLeft</code>. These are put into a global <code>QGridSizer</code> just below and left of the main histogram plot <code>plothist</code>. The axes of these plots are linked to the main plot, so zooming one affects the other plot too and their axes are inverted, so the drawn histogram elongates to the left and to the bottom (starting with 0 at the main plot <code>plothist</code>):</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">QGridLayout</a>* <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">lay</a>;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>* <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>(&amp;<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">mainWidget</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">lay</a>-&gt;addWidget(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>,0,1);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>-&gt;getPlotter()-&gt;setPlotLabel(<span class="stringliteral">&quot;Histograms&quot;</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_datastore.html">JKQTPDatastore</a>* <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>-&gt;getDatastore();</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>* <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>, &amp;<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">mainWidget</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">lay</a>-&gt;addWidget(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>,0,0);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>* <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_plotter.html">JKQTPlotter</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>, &amp;<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">mainWidget</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">lay</a>-&gt;addWidget(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>,1,1);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>-&gt;synchronizeYToMaster(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>-&gt;setAbsoluteX(0,1);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>-&gt;getXAxis()-&gt;setInverted(<span class="keyword">true</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>-&gt;getXAxis()-&gt;setShowZeroAxis(<span class="keyword">false</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>-&gt;getYAxis()-&gt;setShowZeroAxis(<span class="keyword">false</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>-&gt;getYAxis()-&gt;setDrawMode1(<a class="code hl_enumvalue" href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133a5421e479680929799463584b9b56ff4b">JKQTPCADMLine</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>-&gt;getYAxis()-&gt;setDrawMode2(<a class="code hl_enumvalue" href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133ad14d7cc9855aab1f2cd19daca6aceea1">JKQTPCADMLineTicks</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistLeft</a>-&gt;setGrid(<span class="keyword">false</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>-&gt;synchronizeXToMaster(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>-&gt;setAbsoluteY(0,1);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>-&gt;getYAxis()-&gt;setInverted(<span class="keyword">true</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>-&gt;getXAxis()-&gt;setShowZeroAxis(<span class="keyword">false</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>-&gt;getYAxis()-&gt;setShowZeroAxis(<span class="keyword">false</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>-&gt;getXAxis()-&gt;setDrawMode1(<a class="code hl_enumvalue" href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133a5421e479680929799463584b9b56ff4b">JKQTPCADMLine</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>-&gt;getXAxis()-&gt;setDrawMode2(<a class="code hl_enumvalue" href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133ad14d7cc9855aab1f2cd19daca6aceea1">JKQTPCADMLineTicks</a>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>-&gt;setGrid(<span class="keyword">false</span>);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothistBottom</a>-&gt;setMousePositionShown(<span class="keyword">false</span>);</div>
<div class="ttc" id="aclass_j_k_q_t_p_datastore_html"><div class="ttname"><a href="class_j_k_q_t_p_datastore.html">JKQTPDatastore</a></div><div class="ttdoc">This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...</div><div class="ttdef"><b>Definition</b> jkqtpdatastorage.h:282</div></div>
<div class="ttc" id="aclass_j_k_q_t_plotter_html"><div class="ttname"><a href="class_j_k_q_t_plotter.html">JKQTPlotter</a></div><div class="ttdoc">plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)</div><div class="ttdef"><b>Definition</b> jkqtplotter.h:364</div></div>
<div class="ttc" id="agroup__jkqtpplottersupprt_html_gga3b98f7fd9662593c8c36c55f172d8133a5421e479680929799463584b9b56ff4b"><div class="ttname"><a href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133a5421e479680929799463584b9b56ff4b">JKQTPCADMLine</a></div><div class="ttdeci">@ JKQTPCADMLine</div><div class="ttdoc">draw axis as thick line</div><div class="ttdef"><b>Definition</b> jkqtptools.h:401</div></div>
<div class="ttc" id="agroup__jkqtpplottersupprt_html_gga3b98f7fd9662593c8c36c55f172d8133ad14d7cc9855aab1f2cd19daca6aceea1"><div class="ttname"><a href="group__jkqtpplottersupprt.html#gga3b98f7fd9662593c8c36c55f172d8133ad14d7cc9855aab1f2cd19daca6aceea1">JKQTPCADMLineTicks</a></div><div class="ttdeci">@ JKQTPCADMLineTicks</div><div class="ttdoc">draw axis with ticks and line</div><div class="ttdef"><b>Definition</b> jkqtptools.h:412</div></div>
</div><!-- fragment --><p>This results in a graph like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_marginhist.png" alt="datastore_statistics_2d_marginhist" class="inline"/></p>
<p>With the same method, also marginal Kernel Density Estimates can be drawn:</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwx</a>=<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#ga6f694ee485a9939331ed0ef6fe423706">jkqtpstatEstimateKDEBandwidth</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>));</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#gaab1d97b4953dbe7ed0f78d2b29d8f341">jkqtpstatAddHKDE1DAutoranged</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plotkdeBottom</a>-&gt;getPlotter(),  <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), 0.01, &amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gacddebeb94f8449c98b0ed98160e65a24">jkqtpstatKernel1DGaussian</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwx</a>);</div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwy</a>=<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde.html#ga6f694ee485a9939331ed0ef6fe423706">jkqtpstatEstimateKDEBandwidth</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>));</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga4d6431fd319ea8517ee85b99fb6437cb">jkqtpstatAddVKDE1DAutoranged</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plotkdeRight</a>-&gt;getPlotter(),  <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), 0.01, &amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__1dkde__kernels.html#gacddebeb94f8449c98b0ed98160e65a24">jkqtpstatKernel1DGaussian</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwy</a>);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde__kernels_html_gacddebeb94f8449c98b0ed98160e65a24"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde__kernels.html#gacddebeb94f8449c98b0ed98160e65a24">jkqtpstatKernel1DGaussian</a></div><div class="ttdeci">jkqtmath_LIB_EXPORT double jkqtpstatKernel1DGaussian(double t)</div><div class="ttdoc">a 1D Gaussian kernel function, e.g. for Kernel Density Estimation</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__1dkde_html_ga6f694ee485a9939331ed0ef6fe423706"><div class="ttname"><a href="group__jkqtptools__math__statistics__1dkde.html#ga6f694ee485a9939331ed0ef6fe423706">jkqtpstatEstimateKDEBandwidth</a></div><div class="ttdeci">double jkqtpstatEstimateKDEBandwidth(InputIt first, InputIt last)</div><div class="ttdoc">estimates a bandwidth for a Kernel Density Estimator (KDE) of the given data first ....</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:167</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga4d6431fd319ea8517ee85b99fb6437cb"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga4d6431fd319ea8517ee85b99fb6437cb">jkqtpstatAddVKDE1DAutoranged</a></div><div class="ttdeci">JKQTPXYLineGraph * jkqtpstatAddVKDE1DAutoranged(JKQTBasePlotter *plotter, InputIt first, InputIt last, int Nout=100, const std::function&lt; double(double)&gt; &amp;kernel=std::function&lt; double(double)&gt;(&amp;jkqtpstatKernel1DGaussian), double bandwidth=1.0, bool cummulative=false, const QString &amp;KDEcolumnBaseName=QString(&quot;KDE&quot;))</div><div class="ttdoc">calculate an autoranged vertical KDE and add a JKQTPXYLineGraph to the given plotter,...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1457</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_gaab1d97b4953dbe7ed0f78d2b29d8f341"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#gaab1d97b4953dbe7ed0f78d2b29d8f341">jkqtpstatAddHKDE1DAutoranged</a></div><div class="ttdeci">JKQTPXYLineGraph * jkqtpstatAddHKDE1DAutoranged(JKQTBasePlotter *plotter, InputIt first, InputIt last, int Nout=100, const std::function&lt; double(double)&gt; &amp;kernel=std::function&lt; double(double)&gt;(&amp;jkqtpstatKernel1DGaussian), double bandwidth=1.0, bool cummulative=false, const QString &amp;KDEcolumnBaseName=QString(&quot;KDE&quot;))</div><div class="ttdoc">calculate an autoranged KDE and add a JKQTPXYLineGraph to the given plotter, where the KDE is calcula...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1279</div></div>
</div><!-- fragment --><p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_marginkde.png" alt="datastore_statistics_2d_marginkde" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md61"></a>
2D Histogram</h1>
<p>Calculating 2D-Histograms is implemented in <code><a class="el" href="group__jkqtptools__math__statistics__2dhist.html#gad8ab0d1e867375485e2c64743e12ab44" title="calculate a 2-dimensional histogram from the given data range firstX / firstY ... lastY / lastY">jkqtpstatHistogram2D()</a></code> from the <a class="el" href="group__jkqtptools__math__statistics.html">JKQTPlotter Statistics Library</a>. This functions calculates a histogram on a given grid with the first bin at <code>xmin,ymin</code> and the last bin at <code>xmax,ymax</code>, containing <code>Nx,Ny</code> bins in x-/y-direction. You can use the result to fill new image column (with <code>Nx</code> columns and <code>Ny</code> rows) in a <code><a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a></code>, which can then be used to draw the histogram.</p>
<p>First we have to determine the x- and y-range of data and calculate the number of bins from these:</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> xmin=0, xmax=0;</div>
<div class="line"><span class="keywordtype">double</span> ymin=0, ymax=0;</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>), xmin,xmax);</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>), ymin,ymax);</div>
<div class="line"><span class="keywordtype">size_t</span> Nx=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">jkqtp_ceilTo&lt;size_t&gt;</a>((xmax-xmin)/2.0);</div>
<div class="line"><span class="keywordtype">size_t</span> Ny=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">jkqtp_ceilTo&lt;size_t&gt;</a>((ymax-ymin)/2.0);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__basic_html_ga88686b7d786896c704659dc8fe4c1e7f"><div class="ttname"><a href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a></div><div class="ttdeci">void jkqtpstatMinMax(InputIt first, InputIt last, double &amp;min, double &amp;max, InputIt *minPos=nullptr, InputIt *maxPos=nullptr, size_t *Noutput=nullptr)</div><div class="ttdoc">calculates the minimum and maximum values in the given data range first ... last</div><div class="ttdef"><b>Definition</b> jkqtpstatbasics.h:167</div></div>
</div><!-- fragment --><p>Now we can add the image column </p><div class="fragment"><div class="line"><span class="keywordtype">size_t</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">histcol</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;addImageColumn(Nx, Ny, <span class="stringliteral">&quot;2d histogram&quot;</span>);</div>
</div><!-- fragment --><p> and calculate the histogram: </p><div class="fragment"><div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__2dhist.html#gad8ab0d1e867375485e2c64743e12ab44">jkqtpstatHistogram2D</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>),</div>
<div class="line">                     <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">histcol</a>),</div>
<div class="line">                     xmin, xmax, ymin, ymax,</div>
<div class="line">                     Nx, Ny, <span class="keyword">true</span>);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dhist_html_gad8ab0d1e867375485e2c64743e12ab44"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dhist.html#gad8ab0d1e867375485e2c64743e12ab44">jkqtpstatHistogram2D</a></div><div class="ttdeci">void jkqtpstatHistogram2D(InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, OutputIt histogramImgOut, double xmin, double xmax, double ymin, double ymax, size_t xbins=10, size_t ybins=10, bool normalized=true)</div><div class="ttdoc">calculate a 2-dimensional histogram from the given data range firstX / firstY ... lastY / lastY</div><div class="ttdef"><b>Definition</b> jkqtpstathistogram.h:287</div></div>
</div><!-- fragment --><p>Finally the histogram is drawn using a <code><a class="el" href="class_j_k_q_t_p_column_math_image.html" title="class to plot an image from an 2-dimensional array of values stored in a column of the datastore">JKQTPColumnMathImage</a></code>: </p><div class="fragment"><div class="line"><a class="code hl_class" href="class_j_k_q_t_p_column_math_image.html">JKQTPColumnMathImage</a>* <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gHist</a>;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>-&gt;addGraph(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gHist</a>=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_p_column_math_image.html">JKQTPColumnMathImage</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>));</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gHist</a>-&gt;setImageColumn(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">histcol</a>));</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gHist</a>-&gt;setX(xmin);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gHist</a>-&gt;setY(ymin);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gHist</a>-&gt;setWidth(xmax-xmin);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gHist</a>-&gt;setHeight(ymax-ymin);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gHist</a>-&gt;setTitle(<span class="stringliteral">&quot;2D Histogram&quot;</span>);</div>
<div class="ttc" id="aclass_j_k_q_t_p_column_math_image_html"><div class="ttname"><a href="class_j_k_q_t_p_column_math_image.html">JKQTPColumnMathImage</a></div><div class="ttdoc">class to plot an image from an 2-dimensional array of values stored in a column of the datastore</div><div class="ttdef"><b>Definition</b> jkqtpimage.h:777</div></div>
</div><!-- fragment --><p>The resulting image plot looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_hist.png" alt="datastore_statistics_2d_hist" class="inline"/></p>
<p>There is also an "adaptor" which significanty reduce the amount of coude you have to type (<a class="el" href="class_j_k_q_t_p_final_act.html#af964d2f5e77728dfe65e13964ea9b02a">i.e</a>. it replaces all the code above):</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga0903341fc5a3e297a9f6c547df4b222f">jkqtpstatAddHistogram2DImage</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>-&gt;getPlotter(), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>), Nx, Ny, <span class="keyword">true</span>);</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#gac73ef98710f4a642e534daf4d9e18709">jkqtpstatAddHistogram2DContour</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plothist</a>-&gt;getPlotter(), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly</a>), Nx, Ny, <span class="keyword">true</span>);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga0903341fc5a3e297a9f6c547df4b222f"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga0903341fc5a3e297a9f6c547df4b222f">jkqtpstatAddHistogram2DImage</a></div><div class="ttdeci">JKQTPColumnMathImage * jkqtpstatAddHistogram2DImage(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, size_t xbins=10, size_t ybins=10, bool normalized=true, const QString &amp;histogramcolumnBaseName=QString(&quot;histogram&quot;), double *oxmin=nullptr, double *oxmax=nullptr, double *oymin=nullptr, double *oymax=nullptr)</div><div class="ttdoc">calculate calculate a 2-dimensional histogram and add a JKQTPColumnMathImage to the given plotter,...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1059</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_gac73ef98710f4a642e534daf4d9e18709"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#gac73ef98710f4a642e534daf4d9e18709">jkqtpstatAddHistogram2DContour</a></div><div class="ttdeci">JKQTPColumnContourPlot * jkqtpstatAddHistogram2DContour(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, size_t xbins=10, size_t ybins=10, bool normalized=true, const QString &amp;histogramcolumnBaseName=QString(&quot;histogram&quot;), double *oxmin=nullptr, double *oxmax=nullptr, double *oymin=nullptr, double *oymax=nullptr)</div><div class="ttdoc">calculate calculate a 2-dimensional histogram and add a JKQTPColumnContourPlot to the given plotter,...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1114</div></div>
</div><!-- fragment --><p>These differ in the type of plot that is added <code><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga0903341fc5a3e297a9f6c547df4b222f" title="calculate calculate a 2-dimensional histogram and add a JKQTPColumnMathImage to the given plotter,...">jkqtpstatAddHistogram2DImage()</a></code> adds an image graph (<code><a class="el" href="class_j_k_q_t_p_column_math_image.html" title="class to plot an image from an 2-dimensional array of values stored in a column of the datastore">JKQTPColumnMathImage</a></code>) and <code><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#gac73ef98710f4a642e534daf4d9e18709" title="calculate calculate a 2-dimensional histogram and add a JKQTPColumnContourPlot to the given plotter,...">jkqtpstatAddHistogram2DContour()</a></code> adds a contour plot (<code><a class="el" href="class_j_k_q_t_p_column_contour_plot.html" title="class for a contour plots (same as JKQTPContourPlot) of images stored in a JKQTPDatastore column">JKQTPColumnContourPlot</a></code>). A contour plot may look like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_histcontour.png" alt="datastore_statistics_2d_histcontour" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md62"></a>
Kernel Density Estimates (KDE)</h1>
<p>Especially when only few samples from a distribution are available, histograms are not good at representing the underlying data distribution. In such cases, <a href="https://en.wikipedia.org/wiki/Multivariate_kernel_density_estimation">Kernel Density Estimates (KDE)</a> can help, which are basically a smoothed variant of a histogram. The <a class="el" href="group__jkqtptools__math__statistics.html">JKQTPlotter Statistics Library</a> supports calculating them via <a class="el" href="class_j_k_q_t_p_final_act.html#af964d2f5e77728dfe65e13964ea9b02a">e.g</a>. <code><a class="el" href="group__jkqtptools__math__statistics__2dkde.html#gabea5faa220697a680179e0460ab6a46d" title="calculate an autoranged 2-dimensional Kernel Density Estimation (KDE) from the given data range first...">jkqtpstatKDE2D()</a></code>:</p>
<p>This functions calculates a histogram on a given grid with the first bin at <code>xmin,ymin</code> and the last bin at <code>xmax,ymax</code>, containing <code>Nx,Ny</code> bins in x-/y-direction. You can use the result to fill new image column (with <code>Nx</code> columns and <code>Ny</code> rows) in a <code><a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a></code>, which can then be used to draw the histogram.</p>
<p>First we have to determine the x- and y-range of data and calculate the number of bins from these:</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> xmin=0, xmax=0;</div>
<div class="line"><span class="keywordtype">double</span> ymin=0, ymax=0;</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), xmin,xmax);</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__basic.html#ga88686b7d786896c704659dc8fe4c1e7f">jkqtpstatMinMax</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), ymin,ymax);</div>
<div class="line">Nx=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">jkqtp_ceilTo&lt;size_t&gt;</a>((xmax-xmin)/0.1);</div>
<div class="line">Ny=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">jkqtp_ceilTo&lt;size_t&gt;</a>((ymax-ymin)/0.1);</div>
</div><!-- fragment --><p> We can also estimate the KDE-bandwidth for both directions now: </p><div class="fragment"><div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwx</a>=<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#gad32be3dbb22fb9a1c9af695dba13ca43">jkqtpstatEstimateKDEBandwidth2D</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>));</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwy</a>=<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#gad32be3dbb22fb9a1c9af695dba13ca43">jkqtpstatEstimateKDEBandwidth2D</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>));</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde_html_gad32be3dbb22fb9a1c9af695dba13ca43"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde.html#gad32be3dbb22fb9a1c9af695dba13ca43">jkqtpstatEstimateKDEBandwidth2D</a></div><div class="ttdeci">double jkqtpstatEstimateKDEBandwidth2D(InputIt first, InputIt last)</div><div class="ttdoc">estimates a bandwidth for a 2-dimensional Kernel Density Estimator (KDE) of the given data first ....</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:539</div></div>
</div><!-- fragment --><p>Now we can add the image column </p><div class="fragment"><div class="line"><span class="keywordtype">size_t</span> <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">kdecol</a>=<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;addImageColumn(Nx, Ny, <span class="stringliteral">&quot;2d KDE&quot;</span>);</div>
</div><!-- fragment --><p> and calculate the histogram: </p><div class="fragment"><div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde.html#gabea5faa220697a680179e0460ab6a46d">jkqtpstatKDE2D</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>),</div>
<div class="line">                     <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">kdecol</a>),</div>
<div class="line">                     xmin, xmax, ymin, ymax, Nx, Ny,</div>
<div class="line">                     &amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde__kernels.html#ga23d693ecd2ee031496fc14753448f0e0">jkqtpstatKernel2DGaussian</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwx</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwy</a>);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde__kernels_html_ga23d693ecd2ee031496fc14753448f0e0"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde__kernels.html#ga23d693ecd2ee031496fc14753448f0e0">jkqtpstatKernel2DGaussian</a></div><div class="ttdeci">jkqtmath_LIB_EXPORT double jkqtpstatKernel2DGaussian(double tx, double ty)</div><div class="ttdoc">a 1D Gaussian kernel function, e.g. for Kernel Density Estimation</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__2dkde_html_gabea5faa220697a680179e0460ab6a46d"><div class="ttname"><a href="group__jkqtptools__math__statistics__2dkde.html#gabea5faa220697a680179e0460ab6a46d">jkqtpstatKDE2D</a></div><div class="ttdeci">void jkqtpstatKDE2D(InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, OutputIt histogramImgOut, double xmin, double xmax, double ymin, double ymax, size_t xbins, size_t ybins, const std::function&lt; double(double, double)&gt; &amp;kernel=std::function&lt; double(double, double)&gt;(&amp;jkqtpstatKernel2DGaussian), double bandwidthX=1.0, double bandwidthY=1.0)</div><div class="ttdoc">calculate an autoranged 2-dimensional Kernel Density Estimation (KDE) from the given data range first...</div><div class="ttdef"><b>Definition</b> jkqtpstatkde.h:502</div></div>
</div><!-- fragment --><p>Finally the histogram is drawn using a <code><a class="el" href="class_j_k_q_t_p_column_math_image.html" title="class to plot an image from an 2-dimensional array of values stored in a column of the datastore">JKQTPColumnMathImage</a></code>: </p><div class="fragment"><div class="line"><a class="code hl_class" href="class_j_k_q_t_p_column_math_image.html">JKQTPColumnMathImage</a>* <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gKDE</a>;</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plotkde</a>-&gt;addGraph(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gKDE</a>=<span class="keyword">new</span> <a class="code hl_class" href="class_j_k_q_t_p_column_math_image.html">JKQTPColumnMathImage</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plotkde</a>));</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gKDE</a>-&gt;setImageColumn(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">kdecol</a>));</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gKDE</a>-&gt;setX(xmin);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gKDE</a>-&gt;setY(ymin);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gKDE</a>-&gt;setWidth(xmax-xmin);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gKDE</a>-&gt;setHeight(ymax-ymin);</div>
<div class="line"><a class="code hl_class" href="class_j_k_q_t_p_final_act.html">gKDE</a>-&gt;setTitle(<span class="stringliteral">&quot;2D KDE&quot;</span>);</div>
</div><!-- fragment --><p>The resulting plot image looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_kde.png" alt="datastore_statistics_2d_kde" class="inline"/></p>
<p>Note that calculating a KDE is a rather time-consuming task. The KDE in the image above took about 8s to calculate (from 150 datapairs and on a 193*267 pixel grid), whereas the corresponding histogram took only 1ms to calculate!</p>
<p>There is also an "adaptor" which significanty reduce the amount of coude you have to type (<a class="el" href="class_j_k_q_t_p_final_act.html#af964d2f5e77728dfe65e13964ea9b02a">i.e</a>. it replaces all the code above):</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga2169e4129730d013f94ad81ccf47209b">jkqtpstatAddKDE2DImage</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plotkde</a>-&gt;getPlotter(), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), Nx, Ny, &amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde__kernels.html#ga23d693ecd2ee031496fc14753448f0e0">jkqtpstatKernel2DGaussian</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwx</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwy</a>);</div>
<div class="line"><a class="code hl_function" href="group__jkqtptools__math__statistics__adaptors.html#ga7921c9edeb90d7eba8a36076528db331">jkqtpstatAddKDE2DContour</a>(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">plotkde</a>-&gt;getPlotter(), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacolx_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;begin(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">datastore1</a>-&gt;end(<a class="code hl_class" href="class_j_k_q_t_p_final_act.html">randomdatacoly_small</a>), Nx, Ny, &amp;<a class="code hl_function" href="group__jkqtptools__math__statistics__2dkde__kernels.html#ga23d693ecd2ee031496fc14753448f0e0">jkqtpstatKernel2DGaussian</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwx</a>, <a class="code hl_class" href="class_j_k_q_t_p_final_act.html">bwy</a>);</div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga2169e4129730d013f94ad81ccf47209b"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga2169e4129730d013f94ad81ccf47209b">jkqtpstatAddKDE2DImage</a></div><div class="ttdeci">JKQTPColumnMathImage * jkqtpstatAddKDE2DImage(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, size_t xbins=10, size_t ybins=10, const std::function&lt; double(double, double)&gt; &amp;kernel=std::function&lt; double(double, double)&gt;(&amp;jkqtpstatKernel2DGaussian), double bandwidthX=1.0, double bandwidthY=1.0, const QString &amp;kdecolumnBaseName=QString(&quot;histogram&quot;), double *oxmin=nullptr, double *oxmax=nullptr, double *oymin=nullptr, double *oymax=nullptr)</div><div class="ttdoc">calculate calculate a 2-dimensional kernel density estimate (KDE) and add a JKQTPColumnMathImage to t...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1640</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga7921c9edeb90d7eba8a36076528db331"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga7921c9edeb90d7eba8a36076528db331">jkqtpstatAddKDE2DContour</a></div><div class="ttdeci">JKQTPColumnContourPlot * jkqtpstatAddKDE2DContour(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, size_t xbins=10, size_t ybins=10, const std::function&lt; double(double, double)&gt; &amp;kernel=std::function&lt; double(double, double)&gt;(&amp;jkqtpstatKernel2DGaussian), double bandwidthX=1.0, double bandwidthY=1.0, const QString &amp;kdecolumnBaseName=QString(&quot;histogram&quot;), double *oxmin=nullptr, double *oxmax=nullptr, double *oymin=nullptr, double *oymax=nullptr)</div><div class="ttdoc">calculate calculate a 2-dimensional kernel density estimate (KDE) and add a JKQTPColumnContourPlot to...</div><div class="ttdef"><b>Definition</b> jkqtpstatisticsadaptors.h:1697</div></div>
</div><!-- fragment --><p>These differ in the type of plot that is added <code><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga2169e4129730d013f94ad81ccf47209b" title="calculate calculate a 2-dimensional kernel density estimate (KDE) and add a JKQTPColumnMathImage to t...">jkqtpstatAddKDE2DImage()</a></code> adds an image graph (<code><a class="el" href="class_j_k_q_t_p_column_math_image.html" title="class to plot an image from an 2-dimensional array of values stored in a column of the datastore">JKQTPColumnMathImage</a></code>) and <code><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga7921c9edeb90d7eba8a36076528db331" title="calculate calculate a 2-dimensional kernel density estimate (KDE) and add a JKQTPColumnContourPlot to...">jkqtpstatAddKDE2DContour()</a></code> adds a contour plot (<code><a class="el" href="class_j_k_q_t_p_column_contour_plot.html" title="class for a contour plots (same as JKQTPContourPlot) of images stored in a JKQTPDatastore column">JKQTPColumnContourPlot</a></code>). the first is shown in the screenshot above, the latter looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d_kdecontour.png" alt="datastore_statistics_2d_kdecontour" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md63"></a>
Screenshot of the full Program</h1>
<p>The output of the full test program <a href="https://github.com/jkriege2/JKQtPlotter/tree/master/examples/datastore_statistics_2d/datastore_statistics_2d.cpp"><code>datastore_statistics_2d.cpp</code></a> looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_statistics_2d.png" alt="datastore_statistics_2d" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="example_tutorial_projects.html">Example &amp; Tutorial Projects</a></li>
    <li class="footer">Generated on Fri Dec 22 2023 11:58:18 for JKQTPlotter by <a href="https://www.doxygen.org/index.html">doxygen</a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
